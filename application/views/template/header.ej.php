<!DOCTYPE html>

<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>

<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="" name="description"/>
<meta content="" name="author"/>


<script src="<?php echo base_url();?>assets/pace/pace.js"></script>
<link href="<?php echo base_url();?>assets/pace/themes/mytheme.css" rel="stylesheet" />
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/mytitle.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css"/>
<!-- END GLOBAL MANDATORY STYLES -->
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-toastr/toastr.min.css"/>


<!-- <link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/typeahead/typeahead.css">
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/typeahead/style.css">
<link rel="stylesheet" href="<?php echo base_url();?>assets/global/plugins/typeahead/jquery-ui.css">
  <link rel="stylesheet" href="<?php echo base_url();?>assets/global/plugins/typeahead/style.css"> -->
<!-- BEGIN PAGE LEVEL PLUGIN STYLES -->
<link href="<?php echo base_url();?>assets/global/plugins/gritter/css/jquery.gritter.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/fullcalendar/fullcalendar/fullcalendar.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/plugins/jqvmap/jqvmap/jqvmap.css" rel="stylesheet" type="text/css"/>
<!-- END PAGE LEVEL PLUGIN STYLES -->
<!-- BEGIN PAGE STYLES -->
<link href="<?php echo base_url();?>assets/admin/pages/css/tasks.css" rel="stylesheet" type="text/css"/>
<!-- END PAGE STYLES -->

<link href="<?php echo base_url();?>assets/global/plugins/jquery-file-upload/blueimp-gallery/blueimp-gallery.min.css" rel="stylesheet"/>
<link href="<?php echo base_url();?>assets/global/plugins/jquery-file-upload/css/jquery.fileupload.css" rel="stylesheet"/>
<link href="<?php echo base_url();?>assets/global/plugins/jquery-file-upload/css/jquery.fileupload-ui.css" rel="stylesheet"/>
<!-- BEGIN THEME STYLES -->

<!-- BEGIN PAGE LEVEL STYLES -->
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-select/bootstrap-select.min.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/select2/select2.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/jquery-multi-select/css/multi-select.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/datatables/extensions/Scroller/css/dataTables.scroller.min.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/datatables/extensions/ColReorder/css/dataTables.colReorder.min.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-wysihtml5/bootstrap-wysihtml5.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-markdown/css/bootstrap-markdown.min.css">
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-datepicker/css/datepicker.css"/>

<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/clockface/css/clockface.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-datepicker/css/datepicker3.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css"/>


<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/pines-notify/jquery.pnotify.default.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"/>
<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/jquery-tags-input/jquery.tagsinput.css"/>

<link rel="stylesheet" type="text/css" href="<?php echo base_url();?>assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css"/>
<link href="<?php echo base_url();?>assets/admin/pages/css/profile.css" rel="stylesheet" type="text/css"/>


<link href="<?php echo base_url();?>assets/global/css/components.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/global/css/plugins.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/admin/layout/css/layout.css" rel="stylesheet" type="text/css"/>
<link href="<?php echo base_url();?>assets/admin/layout/css/themes/blue.css" rel="stylesheet" type="text/css" id="style_color"/>
<link href="<?php echo base_url();?>assets/admin/layout/css/custom.css" rel="stylesheet" type="text/css"/>
<link rel='stylesheet' type='text/css' href='<?php echo base_url('assets')?>/global/plugins/datatables/dataTables.css' />
<!-- END THEME STYLES -->


<script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/jquery-1.11.0.min.js"></script>
<!-- <script type="text/javascript" src="<?php echo base_url();?>assets/jquery-3.5.1.min.js"></script> -->
<script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="<?php echo base_url();?>assets/global/plugins/pines-notify/jquery.pnotify.min.js"></script>
<script type="text/javascript" src="<?php echo base_url();?>assets/global/scripts/jquery.ajaxfileupload.js"></script>
<!-- <script type="text/javascript" src="<?php echo base_url();?>assets/bootstrap/js/bootstrap.min.js"></script> -->


<script src="<?php echo base_url('assets/roles.js');?>"></script>
<!-- END PAGE LEVEL STYLES -->
<link rel="shortcut icon" href="<?php echo base_url();?>assets/fav.png"/>

<style type="text/css">
	ol li {
		/*color: red!important;*/
	}
	.divabled
	{
		pointer-events: none ;/*!important*/
		opacity: 0.7 ;/*!important*/
		background: #fafcfb ;/*!important*/
	}

	.remdivabled
	{
		pointer-events: auto !important;
		opacity: 1 !important;
		background: #fff !important;
	}

	.error {
      color: #ff0000 !important;
   }
   .fc-event{
	    cursor: pointer;
	}


	ul.portal{
	  margin: 0 1rem;
	    list-style-type: none;
	    margin: auto;
	    padding: 0;
	    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
	}
	nav.portal {
	    width: 100%;
	    background-color: #005788;
	}
	li.portal {
    float: left;
	}
	li.portal a, .dropbtn {
	font-size: 15px;
    font-weight: 500;
    display: inline-block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}
 li.portal:hover, .subnav:hover .subnavbtn {
    background-color: #023958;
  }
  .dropdown-menu a{
  	width: 100%;
  }
  .pull-right>.dropdown-menu {
    right: 0;
    left: unset;
    background: #347ba2;
	width: 100%;
    border: 0;
   }
   .dropdown-menu .divider{
   	margin: unset;
   }
	.hamb{
		display:none;
	}
@media only screen and (max-width: 900px) {
  li.portal a, .dropbtn {
    font-size: 11px;
    padding: 14px 8px
	}
	.page-container{
		margin-top: 45px !important;
	}
	.hamb{
		display:block;
	}
}
</style>
</head>
<!-- END HEAD -->
<!-- BEGIN BODY --><!-- DOC: Apply "page-header-fixed-mobile" and "page-footer-fixed-mobile" class to body element to force fixed header or footer in mobile devices -->
<!-- DOC: Apply "page-sidebar-closed" class to the body and "page-sidebar-menu-closed" class to the sidebar menu element to hide the sidebar by default -->
<!-- DOC: Apply "page-sidebar-hide" class to the body to make the sidebar completely hidden on toggle -->
<!-- DOC: Apply "page-sidebar-closed-hide-logo" class to the body element to make the logo hidden on sidebar toggle -->
<!-- DOC: Apply "page-sidebar-hide" class to body element to completely hide the sidebar on sidebar toggle -->
<!-- DOC: Apply "page-sidebar-fixed" class to have fixed sidebar -->
<!-- DOC: Apply "page-footer-fixed" class to the body element to have fixed footer -->
<!-- DOC: Apply "page-sidebar-reversed" class to put the sidebar on the right side -->
<!-- DOC: Apply "page-full-width" class to the body element to have full width page without the sidebar menu -->
<!-- <body class="page-header-fixed page-quick-sidebar-over-content"> -->

<body oncontextmenu="return false" class="page-quick-sidebar-over-content page-header-fixed page-sidebar-fixed page-footer-fixed page-sidebar-closed-hide-logo">
<!-- BEGIN HEADER -->

<nav class="portal" style="position: fixed;top: 0;z-index: 9;">
    <ul class="portal">
      
		<li class="portal"><img src="<?php echo base_url('/assets/login/logo.png')?>" width="30" height="30" style="margin-left: 10px;"><a href="#">PNRI Infosys</a></li>
	    <li class="portal"><a href="https://admin.services.pnri.dost.gov.ph/pps">PPIS</a></li>
	    <li class="portal"><a href="http://dtms.intranet.pnri/" target="__blank">DTMS</a></li>
	    <li class="portal"><a href="https://outlook.office.com/mail/inbox" target="__blank">Outlook</a></li>
	    <li class="portal"><a href="http://helpdesk.intranet.pnri/" target="__blank">IT Helpdesk</a></li>
		<li class="portal hamb pull-right" style="padding: 12px;color: white;" onclick="$('.page-sidebar').toggleClass('collapse')">
			<i class="fa fa-list"></i>
		</li>
		<li class="portal pull-right dropdown dropdown-user">
			<a href="#" class="dropdown-toggle"   data-toggle="dropdown" data-hover="dropdown" data-close-others="true" style="font-weight: 400;">Hi, <?php echo ucwords(strtolower($this->session->userdata('name'))); ?>
			<i class="fa fa-angle-down"></i></a>

		<ul class="dropdown-menu">
	        			<li class="username">
	                        <a href="#">
	        				    <i class="icon-user"></i><small>Emp #: <span><?php echo $this->session->userdata('empNum');?></span></small>
	                        </a>
	        			</li>
						<li class="divider"> </li>
						<li>
							<a data-toggle="modal" href="#mchangepass" onclick="$('#guid').val('<?php echo $this->session->userdata('userid');?>');$('#gname').val('<?php echo $this->session->userdata('username');?>')">
							<i class="icon-key"></i> Change Password
							</a>
						</li>
						<li>
							<a data-toggle="modal" href="#mlogout">
							<i class="icon-lock"></i> Log Out </a>
						</li>
					</ul>

				</li>
		<li class="portal pull-right"><a href="<?php echo base_url('hr/dtr')?>">DTR</a></li>
		<li class="portal pull-right"><a href="<?php echo base_url('cash/eprint')?>">Payslip</a></li>

	</ul>
  </nav>

<!-- <li class="dropdown dropdown-user">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
					<img alt="" class="img-circle" src="<?php echo base_url();?>assets/pnri_logo_trans.gif"/>
					<span class="username username-hide-on-mobile">
					Hi,  </span>
					<i class="fa fa-angle-down"></i>
					</a>
					
				</li> -->
<!-- LOGOUT /.modal -->
<div id="mlogout" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog modal-full">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
				<h4 class="modal-title">Log-Out Confirmation</h4>
			</div>
			<div class="modal-body" align=center>
				<table width="50%" border=0px>
					<tr><td><span><h2><i class="icon-login"></i> Log <b>Out</b> ?</h2></span></tr>
					<tr><td><span>Are you sure you want to log out?</span></tr>
					<tr><td><span>Press No if you want to continue work. Press Yes to logout current user.</span></tr>
				</table>
			</div>
			<div class="modal-footer">
				<a class="btn red" href="<?php echo base_url('access/logout');?>" onclick="localStorage.clear();">
				<i class="icon-check"></i> YES </a>

				<a class="btn blue" class="btn default" data-dismiss="modal">
				<i class="icon-no"></i> NO </a>
			</div>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
<!-- LOGOUT /.modal -->
<!-- LOGOUT /.modal -->
<div id="mchangepass" class="modal fade" tabindex="-1" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button> -->
				<h4 class="modal-title">Change Password Form</h4>
			</div>
			<div class="modal-body" align=center>
				<form action="#" id="form_standard" class="form-horizontal" method="POST">
					<table width="70%" border=0px>
						<tr><td><center><span><h2><i class="icon-lock"></i> Change <b>Password</b></h2></span>
						</tr>
						<tr><td>
							<div class="form-group" id="divpass">
								<label class="control-label col-md-5">New Password <span class="required">
								* </span>
								</label>
								<div class="col-md-6">
									<div class="input-icon right">
										<i class="fa"></i>
										<input type="password" class="form-control" required="required" name="password" id="password"/>
										<span id="passresult"></span>
									</div>
								</div>
							</div>
						</tr>
						<tr><td>
							<div class="form-group" id="divrpass">
								<label class="control-label col-md-5">Confirm Password <span class="required">
								* </span>
								</label>
								<div class="col-md-6">
									<div class="input-icon right">
										<i class="fa"></i>
										<input type="password" class="form-control" required="required" name="rpassword" id="rpassword"/>
									</div>
								</div>
							</div>
						</tr>
					</table>
				</form>
			</div>
			<div class="modal-footer">
				<div class="alert alert-info display-hide" id="ginfo" >
					<center><img src='<?php echo base_url('assets/global/img/spinner.gif');?>'/><strong> Heads up! </strong>Please wait while we process your request...</center>
				</div>
				<div class="alert alert-danger display-hide" id="gdanger" >
					<center><strong> Oooohps! </strong>Nothing was updated! Change some fields!</center>
				</div>
				<div class="alert alert-success display-hide" id="gsucc" >
					<center><strong> Well done!</strong> Password changed successfully </center>
				</div>

				<div id="gfoot">
					<a class="btn green" onclick="gbtnsubmitP()">
					<i class="icon-check"></i> Save </a>

					<a class="btn blue cpClose" class="btn default" data-dismiss="modal" onclick="gclearme('#form_standard');$('#gsucc').hide();$('#gdanger').hide();">
					<i class="icon-close"></i> Close </a>
				</div>
			</div>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
<!-- LOGOUT /.modal -->

<!-- BEGIN CONTAINER -->
<div class="page-container">
	<!-- BEGIN SIDEBAR -->
	<div class="page-sidebar-wrapper">
		<!-- DOC: Set data-auto-scroll="false" to disable the sidebar from auto scrolling/focusing -->
		<!-- DOC: Change data-auto-speed="200" to adjust the sub menu slide up/down speed -->
		<div class="page-sidebar navbar-collapse collapse">
			<!-- BEGIN SIDEBAR MENU -->
			
			<ul class="page-sidebar-menu" data-auto-scroll="true" data-slide-speed="200">
				<li class="hidden start <?php if ($menu == 'dashboard') echo  ' active open';?> mmenu">
					<a href="<?php echo base_url('dashboard/');?>">
					<i class="icon-home"></i>
					<span class="title">Home</span>
					</a>
				</li>
					<li class="<?php if ($gmenu == 'main' || $gmenu == 'payment') echo  ' open';?> mmenu">
						<a href="javascript:;"><font style="color:#56de68; font-weight: bold;">Main Menu</font></a>
					</li>
						<li class="<?php if ($menu == 'profile') echo  'start active open';?> limenu">
							<a href="<?php echo base_url('hr/employee/');?>">
							<i class="icon-user"></i>
							Profile</a>
						</li>
						<li class="<?php if ($gmenu == 'attendance') echo  ' active ';?> open">
							<a href="javascript:;">
							<i class="icon-calendar"></i> Attendance <span class="arrow"></span>
							</a>
							<ul class="sub-menu" style="display: block;">
								<li class="<?php if ($menu == 'calendar') echo  'start active open';?> limenu">
									<a href="<?php echo base_url('hr/calendar');?>">
									Calendar</a>
								</li>
								<li class="<?php if ($menu == 'dtr') echo  'start active open';?> limenu">
									<a href="<?php echo base_url('hr/dtr');?>">
									<span class="title">DTR</span>
									</a>
								</li>
							</ul>
						</li>
						<li class="<?php if ($menu == 'epayslip') echo  'start active open';?> bdgloan limenu">
							<a href="<?php echo base_url('cash/eprint/');?>">
							<i class="fa fa-envelope-o"></i>
							Payslip</a>
						</li>
						<li class="<?php if ($menu == 'receipt') echo  'start active open';?> limenu cashier accountant revme">
							<a href="<?php echo base_url('cash/payment/receipt/');?>">
							<i class="fa fa-align-justify"></i>
							Issue Receipt</a>
						</li>
			</ul>
		</div>
		<audio id="notif_audio"><source src="<?php echo base_url('assets/sounds/notify.ogg');?>" type="audio/ogg"><source src="<?php echo base_url('assets/sounds/notify.mp3');?>" type="audio/mpeg"><source src="<?php echo base_url('assets/sounds/notify.wav');?>" type="audio/wav"></audio>
	</div>
	<!-- END SIDEBAR -->

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script> -->

<script type="text/javascript">
var allowArrowKeys = 1;
var disabledEmpStatus = ["11", "12", "14", "17"];
var myroles = <?php echo json_encode($this->session->userdata('uroles'));?>;

function checkNotSec(){
	$('#mchangepass').modal('hide');
	if(<?php echo $this->session->userdata('notsec');?>){
		$('#mchangepass').modal('show');
		$('.cpClose').addClass('hidden');
	}else{
		$('.cpClose').removeClass('hidden');
	}
}
function removeMe(){
	if(myroles.includes("1"))
		console.log(1)
	if(myroles.includes("3")){
		$(".hrmo").removeClass("hidden hidme revme divabled")
	}
	if(myroles.includes("9"))
		$(".dtradmin").removeClass("hidden hidme revme")
	if(myroles.includes("23"))
		console.log(23)
	if(myroles.includes("26"))
		$(".accountant").removeClass("hidden hidme revme")
	if(myroles.includes("25"))
		$(".cashier").removeClass("hidden hidme revme")
	if(myroles.includes("27"))
		console.log(27)
	if(myroles.includes("34"))
		console.log(34)
	if(myroles.includes("7"))
		console.log(7)
	if(myroles.includes("35"))
		console.log(35)
	if(myroles.includes("4"))
		console.log(4)
	$(".hidme").hide()
	$(".revme").remove()
}
removeMe()

function ggetDTRDates() {
	$.ajax ({  type:"POST", async: true, dataType: 'json', cache: false,
      url:"<?=site_url('hr/dtr/ggetDTRDates');?>",
      success: function(data) {
		$("#ftrDTRDates").html(data);
		$('#ftrDTRDates').val($('#ftrDTRDates option:first').val())
		$('select').select2();
      },
      error: function(data){console.log("We encountered a problem!")}
  });
}

function ggetEmployees(sel) {
	$.ajax ({  type:"POST", async: true, dataType: 'json', cache: false,
      url:"<?=site_url('hr/employee/getEmployees');?>",
      success: function(data) {
		$("#ftrEmployee").html(data);
		if(sel)
			$("#ftrEmployee").val(sel).trigger("change").select2();
		else
			$('#ftrEmployee').val($('#ftrEmployee option:first').val()).select2();
		updateEmployee()
      },
      error: function(data){console.log("We encountered a problem!")},
      complete: function(data){
      	if("<?php echo $menu;?>" == "dtr")
    		if(myroles.includes("9"))
    			$("#ftrEmployee").html("<option value='0'>-----------------------------------</option>"+$("#ftrEmployee").html())
      }
  });
}

function ggetPlantilla() {
	$.ajax ({  type:"POST", async: true, dataType: 'json', cache: false,
      url:"<?=site_url('hr/employee/getPlantilla');?>",
      success: function(data) {
		$("#plantilla").html(data);
		$('select').select2();
      },
      error: function(data){console.log("We encountered a problem!")}
  });
}

function ggetPositions() {
	$.ajax ({  type:"POST", async: true, dataType: 'json', cache: false,
      url:"<?=site_url('hr/employee/getPositions');?>",
      success: function(data) {
		$("#empPos").html(data);
		$('select').select2();
      },
      error: function(data){console.log("We encountered a problem!")}
  });
}

function ggetSections() {
	$.ajax ({  type:"POST", async: true, dataType: 'json', cache: false,
      url:"<?=site_url('common/getSections');?>",
      success: function(data) {
		$("#empSec").html(data);
		$('#empSec').val()
		$('select').select2();
      },
      error: function(data){console.log("We encountered a problem!")}
  });
}

function ggetRoles(userid, inpt) {
	$.ajax ({  type:"GET", async: true, dataType: 'json', cache: false, data:{userid:userid},
      url:"<?=site_url('common/getRoles');?>",
      success: function(data) {
      	if(inpt){
			$(inpt).val(data);
			$(inpt).select2();
			localStorage.removeItem('oUserLevel');
			localStorage.setItem('oUserLevel', data);
      	}
      },
      error: function(data){console.log("We encountered a problem!")}
  });
}

function gclearme(frm){
	$("#alertvalidation").hide();
	$("#successvalidation").hide();
	$("#infovalidation").hide();
	
	$("#alertvalidationsubcat").hide();
	$("#successvalidationsubcat").hide();
	$("#infovalidationsubcat").hide();

	$(frm)[0].reset();
	$(".form-group").removeClass("has-success has-error");
	$("i").removeClass("fa-check fa-warning");
	$(".help-block-error").addClass("hidden");
}

function clearForms(){
	$(".tab-pane").removeClass("divabled");
	$("#alertvalidation").hide();
	$("#successvalidation").hide();
	$("#infovalidation").hide();
	$('form').trigger("reset");;
	$(".form-group").removeClass("has-success has-error");
	$("i").removeClass("fa-check fa-warning");
	$(".help-block-error").addClass("hidden");
	$(".btnSubmit").addClass("hidden");
	$("#btnSaveNewEmployee").removeClass("hidden");
	$("#btnSavePersonInfo").addClass("hidden");
	$(".btnNext").removeClass("hidden");

	// $("li").prop("style", "pointer-events: none;");
	$(".nav-tabs").prop("style", "pointer-events: none;");
	$(".frmFilter").prop("style", "pointer-events: none;");
	$("#empUserLevel").val("1");
	$("#empPass").addClass("divabled").prop('placeholder', 'auto-generated');
	$("#empUserLevel").select2();
	// $(inpt).select2();
	$("#empAppDate").datepicker("setDate", new Date());
	$("#empAssDate").datepicker("setDate", new Date());
	$('select').select2();
	$.uniform.update();
	nextForm(1)
	allowArrowKeys = 0;
}

function cancelNew(){
	allowArrowKeys = 1;
	$(".nav-tabs").prop("style", "");
	$(".frmFilter").prop("style", "");
	$(".btnNext").addClass("hidden");
	$(".btnPrev").addClass("hidden");
	$(".btnSubmit").removeClass("hidden");
	$("#btnSaveNewEmployee").addClass("hidden");
	$("#btnSavePersonInfo").removeClass("hidden");
	$("#empPass").removeClass("divabled");
    $("label.error, label.has-error").addClass("hidden");
    $("input.error").prop("style", "color: black;");
	updateEmployee()
}

function nextForm(frm){
	$("#firstname").focus();
	$(".btnNext").addClass("hidden");
	$(".btnPrev").addClass("hidden");
	switch(frm) {
		case 1:
			$(".tb2").removeClass("active");
			$(".tb1").addClass("active");
			$(".btnNext").removeClass("hidden");
			break;
		case 2:
			$(".tb1").removeClass("active");
			$(".tb2").addClass("active");
			$(".btnPrev").removeClass("hidden");
			break;
		default:
			// code block
	}
}

function updatePass(url, acc, accname, accid){
    $.ajax
    ({  type:"POST",
        async: true,
        url: "<?php echo site_url('admin/"+url+"Acc'); ?>",
        data: {	acc:acc, accname:accname, accid:accid},
		dataType: 'json',
		cache: false,
        success: function(data)
        {
			$('#processvalidation').hide();
			if(url == "new"){
				url = "CREATED";
				localStorage.setItem('ouid', data);
				aCalldu({id:localStorage.getItem('ouid'), uref:$("#empUserLevel").val()});
			}else
				url = "UPDATED";

        	if(data){
				$('#mchangepass').modal('hide');
				$('.modal-backdrop').remove();
				toastr.success("USER "+url, "SUCCESS");
        	}
			else{
				console.log("INFO: User was not "+url)
    			// toastr.info("Password was not updated", "INFO");
    			checkNotSec()
			}
        },
        error: function(data)
        {
            toastr.error('PLEASE RELOAD THE PAGE AND TRY AGAIN.', 'OOOOOPHS! WE ENCOUNTERED A PROBLEM') 
        }
    })
}

function aCall(a, w, t, c, i, d, u){
    $.ajax
    ({  type:"POST",
        async: true,
        url: u,
        data: {	tbl:t, col:c, id:i, udata: d},
		dataType: 'json',
		cache: false,
        success: function(data)
        {
			$('#processvalidation').hide();
        	if(data[0])
				toastr.success("SUCCESSFULLY "+a+" "+w, "SUCCESS");
			else
    			console.log(w+" WAS NOT "+a);

        },
        error: function(data)
        {
            toastr.error('PLEASE RELOAD THE PAGE AND TRY AGAIN.', 'OOOOOPHS! WE ENCOUNTERED A PROBLEM') 
        }, 
        complete: function(c){
        	if(c.status==200)
				switch(w) {
					case "HOLIDAYS & SUSPENSIONS":
						$('#calendar').fullCalendar( 'refetchEvents' );
						break;
					default:
						// code block
				}
        }
    })
}

function aCallc(a, w, t, c, d, u){
	$.ajax
    ({  type:"POST",
        async: true,
        url: u,
        data: {	tbl:t, con:c, udata: d},
		dataType: 'json',
		cache: false,
        success: function(data)
        {
			$('#processvalidation').hide();
        	if(data)
				toastr.success("SUCCESSFULLY "+a+" "+w, "Success");
			else
    			console.log(w+" WAS NOT "+a, "INFO");

        },
        error: function(data)
        {
            toastr.error('PLEASE RELOAD THE PAGE AND TRY AGAIN.', 'OOOOOPHS! WE ENCOUNTERED A PROBLEM') 
        },
    })
}
//delete update
function aCalldu(d){
	$.ajax
    ({  type:"POST",
        async: true,
        url: "<?php echo site_url('hr/employee/updateUserLevel'); ?>",
        data: {	udata: d},
		dataType: 'json',
		cache: false,
        success: function(data)
        {
			$('#processvalidation').hide();
        	if(data)
				toastr.success("SUCCESSFULLY UPATED USER LEVEL", "Success");
			else
    			console.log("USER LEVEL WAS NOT UPDATED", "INFO");

        },
        error: function(data)
        {
            toastr.error('PLEASE RELOAD THE PAGE AND TRY AGAIN.', 'OOOOOPHS! WE ENCOUNTERED A PROBLEM');
        }, 
        complete: function(c){
        	// if(c.status==200)
        }
    })
}

function gdelete(tbl, col, id)
{
	$.ajax
	({  type:"POST",
	    async: true,
	    url: "<?php echo site_url('common/delete'); ?>",
	    data: {	tbl:tbl, col:col, id:id},
		dataType: 'json',
		cache: false,
	    success: function(data)
	    {
	    	if(data)
				toastr.success("DELETED", "SUCCESS");
			else
				toastr.error("DELETE ERROR", "ERROR");
	    },
	    error: function(data)
	    {
	        toastr.error('PLEASE RELOAD THE PAGE AND TRY AGAIN.', 'OOOOOPHS! WE ENCOUNTERED A PROBLEM') 
	    }, 
        complete: function(c){
        	if(c.status==200)
				switch(col) {
					case "holidays_id":
						$('#calendar').fullCalendar( 'refetchEvents' );
						break;
					default:
						// code block
				}
        }
	})
}

function gexportExcel(tbl) {
	var htmltable= document.getElementById(tbl);
	var html = htmltable.outerHTML;
	window.open('data:application/vnd.ms-excel,' + encodeURIComponent(html));
}

jQuery(function($) {
	toastr.options = {
		"closeButton": true,
		"debug": false,
		"newestOnTop": true,
		"progressBar": true,
		"progressClass": "toast-progress",
		"positionClass": "toast-top-full-width",
		"showDuration": "1000",
		// "preventDuplicates": true,
		"onclick": null,
		"showDuration": "300",
		"hideDuration": "1000",
		"timeOut": "8000",
		"extendedTimeOut": "1000",
		// "showEasing": "swing",
		// "hideEasing": "linear",
		"showEasing": "easeOutBounce",
		"hideEasing": "easeInBack",
		"closeEasing ": "easeInBack",
		"showMethod": "slideDown",
		"hideMethod": "slideUp"
		// "showMethod": "fadeIn",
		// "hideMethod": "fadeOut"
	}

	$('.mail').on("input", function(event) {
	    var ar = /^[ A-Za-z0-9-_.]*$/;
		if (ar.test(this.value) == false) {
			event.preventDefault();
			$('span.mail').text('Please input a valid email.');
			$(this).val(this.value.replace(event.originalEvent.data, ''));
    		return false;
		}else $('span.mail').text('');
	});

	$("input[type=password]").focus(function() {
		$(this).select();
	});

	$('.btnNext').on("click", function(e) {
		e.preventDefault();
		$(this).closest("form").prop('id', 'form_sample_2')
		if($("#form_sample_2").valid())
			nextForm(2)
		else
			return;
	});

	$(document).on('keydown',function(e){
		if(allowArrowKeys){
			if ((e.keyCode || e.which) == 37){
				try{
					$('#btnPrev').click();
				} catch(err)
				{console.log(err)}
			}
			if ((e.keyCode || e.which) == 39){
				try{
					$('#btnNext').click();
				} catch(err)
				{console.log(err)}
			}
		}
	});
})
</script>

<!-- Header JS -->
<script type="text/javascript">
	$('#password').keyup(function() {
		$('#passresult').html(checkStrength($('#password').val()))
	})

	function gbtnsubmitP(){
	    if($("#password").val())
	    {
	        // $('.spnocassion').addClass("hidden");
	        updatePass('update', $('#password').val(), 0, "<?php echo $this->session->userdata('empid');?>");
	        $('#mchangepass').modal('hide');
	    }//else
	        //$('.spnocassion').removeClass("hidden");
	}

	function checkStrength(password) {
		var strength = 0
		// if (password.length < 4) {
		// 	$('#result').removeClass()
		// 	$('#result').addClass('short')
		// 	return ''
		// }
		if (password.length > 4) strength += 1
		// If password contains both lower and uppercase characters, increase strength value.
		if (password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)) strength += 1
		// If it has numbers and characters, increase strength value.
		if (password.match(/([a-zA-Z])/) && password.match(/([0-9])/)) strength += 1
		// If it has one special character, increase strength value.
		if (password.match(/([!,%,&,@,#,$,^,*,?,_,~])/)) strength += 1
		// If it has two special characters, increase strength value.
		if (password.match(/(.*[!,%,&,@,#,$,^,*,?,_,~].*[!,%,&,@,#,$,^,*,?,_,~])/)) strength += 1
		// Calculated strength value, we can return messages
		// If value is less than 2
		$("#passresult").removeClass();
		if (strength < 2) {
			$("#passresult").addClass("font-red")
			return 'Weak'
		} else if (strength == 2) {
			$("#passresult").addClass("font-blue")
			return 'Good'
		} else {
			$("#passresult").addClass("font-green")
			return 'Strong'
		}
	}
</script>

<!-- Calendar JS -->
<script type="text/javascript">
function clearCalendar(){
    $('.spnocassion').addClass("hidden");
    $('#hDate').text("");
    $('#hid').val("");
    $('#holidays_ref_id').val(1);
    $('#sdate').val("");
    $('#occasion').val("");
    $('#repeats').val(0);
    $('select').select2();
}

jQuery(document).ready(function() {   
	$('[data-toggle=confirmation]').confirmation({
		rootSelector: '[data-toggle=confirmation]',
		onConfirm: function() {
			alert("2");
			$('[data-toggle=confirmation]').confirmation('hide');
		},
		popout: true
	});

    $('#calendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,basicWeek,basicDay'
        },
        editable: true, disableDragging: true, disableResizing: true,
        viewDisplay: function(v) {
            console.log("calendar viewDisplay")
            /*$('#yPick option:contains('+v.start.getFullYear()+')').attr("selected", true);
            $('#mPick option[value='+v.start.getMonth()+']').attr("selected", true);*/
        },
        events: function(start, end, callback) {
            // do some asynchronous ajax
            $.getJSON("<?php echo base_url('hr/Calendar/getHolidaysold'); ?>",
                {
                    start: start.getTime(),
                    end: end.getTime(),
                    action: "calendarData"
                },
                function(events) {
                    callback(events);
                });
        },
        eventDrop: function(event, delta) {
            alert(event.title + ' was moved ' + delta + ' days\n' +
                '(should probably update your database)');
        },
        loading: function(bool) {
            console.log("calendar loading")
            /*if (bool){ $('#cover').show(); $('#loading').show() }
            else { $('#loading').hide(); $('#cover').hide(); }*/
        },
        dayClick: function(day, view){
	        console.log("calendar dayClick")
			if(myroles.includes("9")){
	            clearCalendar()
	            // console.log(yourDate.toISOString().split('T')[0])
	            $('.gbtndeleteH').addClass('hidden');
	            $('#mHoliday').modal('hide');
	            $('#mHoliday').modal('show');

	            var yourDate = day;
	            const offset = yourDate.getTimezoneOffset();
	            yourDate = new Date(yourDate.getTime() - (offset*60*1000));
	            $('#sdate').val(yourDate.toISOString().split('T')[0]);
	            $('#hDate').text(day.toDateString());
			}
        },
        eventClick: function(i, e, view){
            console.log("calendar eventClick")
			if(myroles.includes("9")){
	            $('.gbtndeleteH').removeClass('hidden');
	            clearCalendar()
	            $('#mHoliday').modal('hide');
	            $('#mHoliday').modal('show');

	            $('.spnocassion').addClass("hidden");

	            var yourDate = i.start;
	            const offset = yourDate.getTimezoneOffset();
	            yourDate = new Date(yourDate.getTime() - (offset*60*1000));
	            $('#sdate').val(yourDate.toISOString().split('T')[0]);

	            $('#hDate').text(i.start.toDateString());
	            $('#hid').val(i.id);
	            $('#holidays_ref_id').val(i.type);
	            $('#occasion').val(i.title);
	            $('#repeats').val(i.repeats);
	            $('select').select2();
	        }
        }
        
    });
});

function gbtndeleteH(){
	var x = confirm("Are you sure?");
	if(x)
		gdelete("infosys.holidays", "holidays_id", $("#hid").val())
    $('#mHoliday').modal('hide');
}

function gbtnsubmitH(){
    if($("#occasion").val())
    {
        $('.spnocassion').addClass("hidden");
        var hurl = "<?php echo site_url('common/add'); ?>";
        var a = "ADDED";
        if($("#hid").val()){
            hurl = "<?php echo site_url('common/update'); ?>";
            a = "UPDATED";
        }
        var hdata = {   holidays_ref_id:$("#holidays_ref_id").val(),
                        sdate:$("#sdate").val(),
                        edate:$("#sdate").val(),
                        occasion:$("#occasion").val(),
                        repeats:$("#repeats").val()
                    };
        aCall(a, "HOLIDAYS & SUSPENSIONS", "infosys.holidays", "holidays_id", $("#hid").val(), hdata, hurl);
        $('#mHoliday').modal('hide');
    }else
        $('.spnocassion').removeClass("hidden");
}
</script>